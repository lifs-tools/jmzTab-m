<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Serializers.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">jmztabm-io</a> &gt; <a href="index.source.html" class="el_package">de.isas.mztab2.io.serialization</a> &gt; <span class="el_source">Serializers.java</span></div><h1>Serializers.java</h1><pre class="source lang-java linenums">/* 
 * Copyright 2018 Leibniz-Institut für Analytische Wissenschaften – ISAS – e.V..
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package de.isas.mztab2.io.serialization;

import com.fasterxml.jackson.annotation.JsonProperty;
import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializerProvider;
import com.fasterxml.jackson.dataformat.xml.annotation.JacksonXmlRootElement;
import de.isas.mztab2.model.Assay;
import de.isas.mztab2.model.IndexedElement;
import de.isas.mztab2.model.OptColumnMapping;
import de.isas.mztab2.model.Parameter;
import de.isas.mztab2.model.StudyVariable;
import de.isas.mztab2.model.Uri;
import java.io.IOException;
import java.lang.reflect.InvocationTargetException;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.Optional;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import java.util.stream.Collectors;
import java.util.stream.IntStream;
import javax.validation.ValidationException;
import lombok.extern.slf4j.Slf4j;
import uk.ac.ebi.pride.jmztab2.model.IMZTabColumn;
import uk.ac.ebi.pride.jmztab2.model.MZTabConstants;
import static uk.ac.ebi.pride.jmztab2.model.MZTabConstants.NULL;
import uk.ac.ebi.pride.jmztab2.model.MetadataElement;
import uk.ac.ebi.pride.jmztab2.model.MetadataProperty;

/**
 * &lt;p&gt;
 * Utility class providing helper methods for other serializers.&lt;/p&gt;
 *
 * @author nilshoffmann
 * @since 11/30/17
 *
 */
<span class="fc" id="L58">@Slf4j</span>
<span class="nc" id="L59">public class Serializers {</span>

    /**
     * &lt;p&gt;
     * getReference.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @param idx a {@link java.lang.Integer} object.
     * @return a {@link java.lang.String} object.
     */
    public static String getReference(Object element, Integer idx) {
<span class="fc" id="L70">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L71">        sb.append(getElementName(element).</span>
<span class="fc" id="L72">                orElseThrow(()</span>
                        -&gt; {
<span class="nc" id="L74">                    return new IllegalArgumentException(</span>
                            &quot;No mzTab element name mapping available for &quot; + element.
<span class="nc" id="L76">                                    getClass().</span>
<span class="nc" id="L77">                                    getName());</span>
                }));

<span class="fc" id="L80">        return sb.toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceAssay.&lt;/p&gt;
     *
     * @param a a {@link de.isas.mztab2.model.Assay} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceAssay(Assay a) {
<span class="nc" id="L91">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L92">        return sb.append(&quot;abundance_assay[&quot;).</span>
<span class="nc" id="L93">                append(a.getId()).</span>
<span class="nc" id="L94">                append(&quot;]&quot;).</span>
<span class="nc" id="L95">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceStudyVar.&lt;/p&gt;
     *
     * @param sv a {@link de.isas.mztab2.model.StudyVariable} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceStudyVar(StudyVariable sv) {
<span class="nc" id="L106">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L107">        return sb.append(&quot;abundance_study_variable[&quot;).</span>
<span class="nc" id="L108">                append(sv.getId()).</span>
<span class="nc" id="L109">                append(&quot;]&quot;).</span>
<span class="nc" id="L110">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printAbundanceCoeffVarStudyVar.&lt;/p&gt;
     *
     * @param sv a {@link de.isas.mztab2.model.StudyVariable} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printAbundanceCoeffVarStudyVar(StudyVariable sv) {
<span class="nc" id="L121">        StringBuilder sb = new StringBuilder();</span>
<span class="nc" id="L122">        return sb.append(&quot;abundance_coeffvar_study_variable[&quot;).</span>
<span class="nc" id="L123">                append(sv.getId()).</span>
<span class="nc" id="L124">                append(&quot;]&quot;).</span>
<span class="nc" id="L125">                toString();</span>
    }

    /**
     * &lt;p&gt;
     * printOptColumnMapping.&lt;/p&gt;
     *
     * @param ocm a {@link de.isas.mztab2.model.OptColumnMapping} object.
     * @return a {@link java.lang.String} object.
     */
    public static String printOptColumnMapping(OptColumnMapping ocm) {
<span class="fc" id="L136">        StringBuilder sb = new StringBuilder();</span>
<span class="fc" id="L137">        log.debug(&quot;Identifier={}; OptColumnMapping: {}&quot;, ocm.getIdentifier(), ocm);</span>
<span class="fc bfc" id="L138" title="All 4 branches covered.">        if (&quot;global&quot;.equals(ocm.getIdentifier()) || ocm.getIdentifier().startsWith(&quot;global&quot;)) {</span>
<span class="fc" id="L139">            sb.append(&quot;opt_&quot;);</span>
<span class="fc" id="L140">            sb.append(ocm.getIdentifier());</span>
<span class="fc bfc" id="L141" title="All 2 branches covered.">            if (ocm.getParam() != null) {</span>
<span class="fc" id="L142">                sb.append(&quot;_cv_&quot;).</span>
<span class="fc" id="L143">                        append(ocm.getParam().</span>
<span class="fc" id="L144">                                getCvAccession()).</span>
<span class="fc" id="L145">                        append(&quot;_&quot;).</span>
<span class="fc" id="L146">                        append(ocm.getParam().</span>
<span class="fc" id="L147">                                getName().</span>
<span class="fc" id="L148">                                replaceAll(&quot; &quot;, &quot;_&quot;));</span>
            }
        } else {
<span class="fc" id="L151">            log.debug(&quot;OptColumnMapping: {}&quot;, ocm);</span>
            // object reference case, value is now the actual value
<span class="fc" id="L153">            sb.append(ocm.getIdentifier());</span>
        }
<span class="fc" id="L155">        log.debug(&quot;asString: {}&quot;, sb.toString());</span>
//        //TODO: check for valid characters in definition
//        //valid characters: ‘A’-‘Z’, ‘a’-‘z’, ‘0’-‘9’, ‘’, ‘-’, ‘[’, ‘]’, and ‘:’.
//        //[A-Za-z0-9\[\]-:]+
<span class="fc" id="L159">        return sb.toString();</span>
    }

    /**
     * &lt;p&gt;
     * addIndexedLine for elements like assay[1] that have an id and one
     * additional property element&lt;/p&gt;
     *
     * @param &lt;T&gt; the type of {@link IndexedElement}.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param indexedElement a {@link de.isas.mztab2.model.Parameter} object.
     */
    public static &lt;T extends Object&gt; void addIndexedLine(
            JsonGenerator jg, SerializerProvider sp, String prefix,
            Object element, T indexedElement) {
<span class="fc" id="L178">        addIndexedLine(jg, sp, prefix, element, Arrays.asList(indexedElement));</span>
<span class="fc" id="L179">    }</span>

    /**
     * &lt;p&gt;
     * addIndexedLine for elements like assay[1] that have an id and a list of
     * additional property elements&lt;/p&gt;
     *
     * @param &lt;T&gt; the type of {@link IndexedElement}.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param indexedElementList a {@link java.util.List} object.
     */
    public static &lt;T extends Object&gt; void addIndexedLine(
            JsonGenerator jg, SerializerProvider sp, String prefix,
            Object element,
            List&lt;T&gt; indexedElementList) {
<span class="fc" id="L198">        Optional&lt;List&lt;T&gt;&gt; iel = Optional.ofNullable(indexedElementList);</span>
<span class="pc bpc" id="L199" title="2 of 4 branches missed.">        if (!iel.isPresent() || indexedElementList.isEmpty()) {</span>

<span class="nc" id="L201">            log.debug(</span>
                    &quot;Skipping null or empty indexed element list values for {}&quot;,
<span class="nc" id="L203">                    getElementName(</span>
                            element));
<span class="nc" id="L205">            return;</span>
        }
        try {
<span class="fc" id="L208">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L210">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L212">            jg.writeString(new StringBuilder().append(getElementName(element).</span>
<span class="fc" id="L213">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L215">                        return new ElementNameMappingException(&quot;unknown&quot;, element);</span>
                    })).
<span class="fc" id="L217">                    toString());</span>
            //value
<span class="fc" id="L219">            jg.writeString(indexedElementList.stream().</span>
<span class="fc" id="L220">                    map((indexedElement)</span>
                            -&gt; {
<span class="fc bfc" id="L222" title="All 2 branches covered.">                        if (indexedElement instanceof Parameter) {</span>
<span class="fc" id="L223">                            return new ParameterConverter().convert(</span>
                                    (Parameter) indexedElement);
<span class="pc bpc" id="L225" title="1 of 2 branches missed.">                        } else if (indexedElement instanceof Uri) {</span>
<span class="fc" id="L226">                            return new UriConverter().convert((Uri) indexedElement);</span>
                        } else {
<span class="nc" id="L228">                            throw new IllegalArgumentException(</span>
<span class="nc" id="L229">                                    &quot;Serialization of type &quot; + indexedElement.getClass() + &quot; currently not supported!&quot;);</span>
                        }
                    }).
<span class="fc" id="L232">                    collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L233">            jg.writeEndArray();</span>
<span class="nc" id="L234">        } catch (IOException ex) {</span>

<span class="nc" id="L236">            log.error(&quot;Caught IO Exception while trying to write indexed line:&quot;,</span>
                    ex);
<span class="fc" id="L238">        }</span>
<span class="fc" id="L239">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param parameterList a {@link java.util.List} object.
     */
    public static void addLineWithParameters(JsonGenerator jg, String prefix,
            Object element,
            List&lt;Parameter&gt; parameterList) {
<span class="pc bpc" id="L253" title="2 of 4 branches missed.">        if (parameterList == null || parameterList.isEmpty()) {</span>

<span class="nc" id="L255">            log.debug(</span>
<span class="nc" id="L256">                    &quot;Skipping null or empty parameter list values for &quot; + getElementName(</span>
                            element));
<span class="nc" id="L258">            return;</span>
        }
        try {
<span class="fc" id="L261">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L263">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L265">            jg.writeString(new StringBuilder().append(getElementName(element).</span>
<span class="fc" id="L266">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L268">                        return new ElementNameMappingException(&quot;unknown&quot;, element);</span>
                    })).
<span class="fc" id="L270">                    toString());</span>
            //value
<span class="fc" id="L272">            jg.writeString(parameterList.stream().</span>
<span class="fc" id="L273">                    map((parameter)</span>
                            -&gt; {
<span class="fc" id="L275">                        return new ParameterConverter().convert(parameter);</span>
                    }).
<span class="fc" id="L277">                    collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L278">            jg.writeEndArray();</span>
<span class="nc" id="L279">        } catch (IOException ex) {</span>
<span class="nc" id="L280">            log.error(</span>
                    &quot;Caught IO Exception while trying to write line with parameters:&quot;,
                    ex);
<span class="fc" id="L283">        }</span>
<span class="fc" id="L284">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithPropertyParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.util.List} object.
     */
    public static void addLineWithPropertyParameters(JsonGenerator jg,
            String prefix,
            String propertyName, Object element,
            List&lt;Parameter&gt; value) {
<span class="pc bpc" id="L300" title="2 of 4 branches missed.">        if (value == null || value.isEmpty()) {</span>

<span class="nc" id="L302">            log.debug(&quot;Skipping null or empty values for {}&quot;,</span>
<span class="nc" id="L303">                    getElementName(</span>
                            element));
<span class="nc" id="L305">            return;</span>
        }
<span class="fc" id="L307">        addLineWithProperty(jg, prefix, propertyName, element, value.stream().</span>
<span class="fc" id="L308">                map((parameter)</span>
                        -&gt; {
<span class="fc" id="L310">                    return new ParameterConverter().convert(parameter);</span>
                }).
<span class="fc" id="L312">                collect(Collectors.joining(&quot;|&quot;)));</span>
<span class="fc" id="L313">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithMetadataProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param property a {@link uk.ac.ebi.pride.jmztab2.model.MetadataProperty}
     * object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLineWithMetadataProperty(JsonGenerator jg,
            String prefix, MetadataProperty property, Object element,
            Object... value) {
<span class="fc" id="L329">        addLineWithProperty(jg, prefix, property.getName(), element, value);</span>
<span class="fc" id="L330">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithNullProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     */
    public static void addLineWithNullProperty(JsonGenerator jg, String prefix,
            String propertyName, Object element) {
        try {
<span class="fc" id="L344">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L346">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L348">            String key = getElementName(element).</span>
<span class="fc" id="L349">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L351">                        return new ElementNameMappingException(propertyName, element);</span>
                    });
<span class="pc bpc" id="L353" title="1 of 2 branches missed.">            if (propertyName == null) {</span>
<span class="nc" id="L354">                jg.writeString(key);</span>
            } else {
<span class="fc" id="L356">                jg.writeString(key + &quot;-&quot; + propertyName);</span>
            }
            //value
<span class="fc" id="L359">            jg.writeString(NULL);</span>
<span class="fc" id="L360">            jg.writeEndArray();</span>
<span class="nc" id="L361">        } catch (IOException ex) {</span>

<span class="nc" id="L363">            log.error(</span>
                    &quot;Caught exception while trying to write line with null property:&quot;,
                    ex);
<span class="fc" id="L366">        }</span>
<span class="fc" id="L367">    }</span>

    /**
     * &lt;p&gt;
     * addLineWithProperty.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param propertyName a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLineWithProperty(JsonGenerator jg, String prefix,
            String propertyName, Object element,
            Object... value) {
<span class="pc bpc" id="L382" title="2 of 4 branches missed.">        if (value == null || value.length == 0) {</span>

<span class="nc" id="L384">            log.debug(&quot;Skipping null or empty values for {}&quot;,</span>
<span class="nc" id="L385">                    getElementName(</span>
                            element));
<span class="nc" id="L387">            return;</span>
        }
<span class="pc bpc" id="L389" title="1 of 4 branches missed.">        if (value.length == 1 &amp;&amp; (value[0] == null)) {</span>

<span class="fc" id="L391">            log.debug(&quot;Skipping empty value for {}&quot;, getElementName(</span>
                    element));
<span class="fc" id="L393">            return;</span>
        }
        try {
<span class="fc" id="L396">            jg.writeStartArray();</span>
            //prefix
<span class="fc" id="L398">            jg.writeString(prefix);</span>
            //key
<span class="fc" id="L400">            String key = getElementName(element).</span>
<span class="fc" id="L401">                    orElseThrow(()</span>
                            -&gt; {
<span class="nc" id="L403">                        return new ElementNameMappingException(propertyName, element);</span>
                    });
<span class="fc bfc" id="L405" title="All 2 branches covered.">            if (propertyName == null) {</span>
<span class="fc" id="L406">                jg.writeString(key);</span>
            } else {
<span class="fc" id="L408">                jg.writeString(key + &quot;-&quot; + propertyName);</span>
            }
            //value
<span class="fc bfc" id="L411" title="All 2 branches covered.">            for (Object o : value) {</span>
<span class="fc" id="L412">                jg.writeObject(o);</span>
            }
<span class="fc" id="L414">            jg.writeEndArray();</span>
<span class="nc" id="L415">        } catch (IOException ex) {</span>

<span class="nc" id="L417">            log.error(</span>
                    &quot;Caught IO exception while trying to write line with property:&quot;,
                    ex);
<span class="fc" id="L420">        }</span>
<span class="fc" id="L421">    }</span>

    /**
     * &lt;p&gt;
     * addLine.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param value a {@link java.lang.Object} object.
     */
    public static void addLine(JsonGenerator jg, String prefix, Object element,
            Object... value) {
<span class="fc" id="L434">        addLineWithProperty(jg, prefix, null, element, value);</span>
<span class="fc" id="L435">    }</span>

    /**
     * &lt;p&gt;
     * getElementName.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.Optional} object.
     */
    public static Optional&lt;String&gt; getElementName(Object element) {
<span class="fc bfc" id="L445" title="All 2 branches covered.">        if (element instanceof String) {</span>
<span class="fc" id="L446">            return Optional.of((String) element);</span>
        }
<span class="fc bfc" id="L448" title="All 2 branches covered.">        if (element instanceof MetadataElement) {</span>
<span class="fc" id="L449">            return Optional.ofNullable(((MetadataElement) element).getName());</span>
        }
<span class="fc" id="L451">        JacksonXmlRootElement rootElement = element.getClass().</span>
<span class="fc" id="L452">                getAnnotation(JacksonXmlRootElement.class);</span>
<span class="pc bpc" id="L453" title="1 of 2 branches missed.">        if (rootElement != null) {</span>
<span class="fc" id="L454">            String underscoreName = camelCaseToUnderscoreLowerCase(</span>
<span class="fc" id="L455">                    rootElement.localName());</span>
<span class="pc bpc" id="L456" title="1 of 2 branches missed.">            if (element instanceof IndexedElement) {</span>
<span class="nc" id="L457">                Integer id = Optional.ofNullable(((IndexedElement) element).getId()).orElseThrow(()</span>
<span class="nc" id="L458">                        -&gt; new NullPointerException(</span>
                                &quot;Field 'id' must not be null for element '&quot; + underscoreName + &quot;'!&quot;)
                );
<span class="nc" id="L461">                return Optional.of(</span>
                        underscoreName + &quot;[&quot; + id + &quot;]&quot;);
            } 
<span class="fc" id="L464">            IndexedElement ielement = IndexedElement.of(element);</span>
<span class="pc bpc" id="L465" title="1 of 2 branches missed.">            if(ielement!=null) {</span>
<span class="fc" id="L466">                Integer id = Optional.ofNullable((ielement).getId()).orElseThrow(()</span>
<span class="nc" id="L467">                        -&gt; new NullPointerException(</span>
                                &quot;Field 'id' must not be null for element '&quot; + underscoreName + &quot;'!&quot;)
                );
<span class="fc" id="L470">                return Optional.of(</span>
                        underscoreName + &quot;[&quot; + id + &quot;]&quot;);
            }
                
<span class="nc" id="L474">            return Optional.ofNullable(underscoreName);</span>
        }
<span class="nc" id="L476">        return Optional.empty();</span>
    }

    /**
     * &lt;p&gt;
     * getPropertyNames.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.List} object.
     */
    public static List&lt;String&gt; getPropertyNames(Object element) {
<span class="nc" id="L487">        return Arrays.asList(element.getClass().</span>
<span class="nc" id="L488">                getAnnotationsByType(JsonProperty.class)).</span>
<span class="nc" id="L489">                stream().</span>
<span class="nc" id="L490">                map((jsonProperty)</span>
                        -&gt; {
<span class="nc" id="L492">                    return jsonProperty.value();</span>
                }).
<span class="nc" id="L494">                collect(Collectors.toList());</span>
    }

    /**
     * &lt;p&gt;
     * asMap.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @return a {@link java.util.Map} object.
     */
    public static Map&lt;String, Object&gt; asMap(Object element) {
<span class="nc" id="L505">        ObjectMapper objectMapper = new ObjectMapper();</span>
<span class="nc" id="L506">        return objectMapper.convertValue(element, Map.class);</span>
    }

    /**
     * &lt;p&gt;
     * camelCaseToUnderscoreLowerCase.&lt;/p&gt;
     *
     * @param camelCase a {@link java.lang.String} object.
     * @return a {@link java.lang.String} object.
     */
    public static String camelCaseToUnderscoreLowerCase(String camelCase) {
<span class="fc" id="L517">        Matcher m = Pattern.compile(&quot;(?&lt;=[a-z])[A-Z]&quot;).</span>
<span class="fc" id="L518">                matcher(camelCase);</span>

<span class="fc" id="L520">        StringBuffer sb = new StringBuffer();</span>
<span class="fc bfc" id="L521" title="All 2 branches covered.">        while (m.find()) {</span>
<span class="fc" id="L522">            m.appendReplacement(sb, &quot;_&quot; + m.group().</span>
<span class="fc" id="L523">                    toLowerCase());</span>
        }
<span class="fc" id="L525">        m.appendTail(sb);</span>
<span class="fc" id="L526">        return sb.toString().</span>
<span class="fc" id="L527">                toLowerCase();</span>
    }

    /**
     * &lt;p&gt;
     * addSubElementStrings.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElements a {@link java.util.List} object.
     * @param oneLine a boolean.
     */
    public static void addSubElementStrings(JsonGenerator jg, String prefix,
            Object element, String subElementName, List&lt;?&gt; subElements,
            boolean oneLine) {
<span class="fc bfc" id="L544" title="All 2 branches covered.">        if (checkForNull(element, subElements, subElementName)) {</span>
<span class="fc" id="L545">            return;</span>
        }
<span class="fc" id="L547">        Serializers.getElementName(element).</span>
<span class="fc" id="L548">                ifPresent((elementName)</span>
                        -&gt; {
<span class="fc bfc" id="L550" title="All 2 branches covered.">                    if (oneLine) {</span>
<span class="fc" id="L551">                        addLine(jg, prefix,</span>
                                elementName + &quot;-&quot; + subElementName,
<span class="fc" id="L553">                                subElements.stream().</span>
<span class="fc" id="L554">                                        map((t)</span>
                                                -&gt; {
<span class="fc" id="L556">                                            return t.toString();</span>
                                        }).
<span class="fc" id="L558">                                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR)));</span>
                    } else {
<span class="fc" id="L560">                        IntStream.range(0, subElements.</span>
<span class="fc" id="L561">                                size()).</span>
<span class="fc" id="L562">                                forEachOrdered(i</span>
                                        -&gt; {
<span class="fc" id="L564">                                    addLine(jg, prefix,</span>
                                            elementName + &quot;-&quot; + subElementName + &quot;[&quot; + (i + 1) + &quot;]&quot;,
                                            subElements.
<span class="fc" id="L567">                                                    get(i));</span>
<span class="fc" id="L568">                                });</span>
                    }
<span class="fc" id="L570">                });</span>

<span class="fc" id="L572">    }</span>

    /**
     * &lt;p&gt;
     * addSubElementParameter.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElement a {@link de.isas.mztab2.model.Parameter} object.
     */
    public static void addSubElementParameter(JsonGenerator jg, String prefix,
            Object element, String subElementName, Parameter subElement) {
<span class="fc bfc" id="L586" title="All 2 branches covered.">        if (subElement == null) {</span>
<span class="fc" id="L587">            String elementName = Serializers.getElementName(element).</span>
<span class="fc" id="L588">                    orElse(&quot;undefined&quot;);</span>

<span class="fc" id="L590">            log.debug(&quot;''{}-{}'' is null or empty!&quot;, new Object[]{</span>
                elementName,
                subElementName});
<span class="fc" id="L593">            return;</span>
        }
<span class="fc" id="L595">        addSubElementStrings(jg, prefix, element, subElementName, Arrays.asList(</span>
<span class="fc" id="L596">                new ParameterConverter().convert(subElement)), true);</span>
<span class="fc" id="L597">    }</span>

    /**
     * &lt;p&gt;
     * addSubElementParameters.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param prefix a {@link java.lang.String} object.
     * @param element a {@link java.lang.Object} object.
     * @param subElementName a {@link java.lang.String} object.
     * @param subElements a {@link java.util.List} object.
     * @param oneLine a boolean.
     */
    public static void addSubElementParameters(JsonGenerator jg, String prefix,
            Object element, String subElementName, List&lt;Parameter&gt; subElements,
            boolean oneLine) {
<span class="fc bfc" id="L613" title="All 2 branches covered.">        if (checkForNull(element, subElements, subElementName)) {</span>
<span class="fc" id="L614">            return;</span>
        }
<span class="fc" id="L616">        addSubElementStrings(jg, prefix, element, subElementName,</span>
<span class="fc" id="L617">                subElements.stream().</span>
<span class="fc" id="L618">                        map((parameter)</span>
                                -&gt; {
                            try {
<span class="fc" id="L621">                                return new ParameterConverter().convert(parameter);</span>
<span class="nc" id="L622">                            } catch (IllegalArgumentException npe) {</span>

<span class="nc" id="L624">                                log.debug(&quot;parameter is null for {}&quot;,</span>
                                        subElementName);
<span class="nc" id="L626">                                return &quot;null&quot;;</span>
                            }
                        }).
<span class="fc" id="L629">                        collect(Collectors.toList()), oneLine);</span>
<span class="fc" id="L630">    }</span>

    /**
     * &lt;p&gt;
     * checkForNull.&lt;/p&gt;
     *
     * @param element a {@link java.lang.Object} object.
     * @param subElements a {@link java.util.List} object.
     * @param subElementName a {@link java.lang.String} object.
     * @return a boolean.
     */
    public static boolean checkForNull(Object element, List&lt;?&gt; subElements,
            String subElementName) {
<span class="fc" id="L643">        String elementName = Serializers.getElementName(element).</span>
<span class="fc" id="L644">                orElse(&quot;undefined&quot;);</span>
<span class="fc bfc" id="L645" title="All 4 branches covered.">        if (subElements == null || subElements.isEmpty()) {</span>

<span class="fc" id="L647">            log.debug(&quot;''{}-{}'' is null or empty!&quot;, new Object[]{</span>
                elementName,
                subElementName});
<span class="fc" id="L650">            return true;</span>
        }
<span class="fc" id="L652">        return false;</span>
    }

    /**
     * &lt;p&gt;
     * writeString.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.String} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeString(String columnName, JsonGenerator jg,
            String value) throws IOException {
<span class="fc bfc" id="L667" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L668">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc" id="L670">            jg.writeStringField(columnName, value);</span>
        }
<span class="fc" id="L672">    }</span>

    /**
     * &lt;p&gt;
     * writeString.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.String} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeString(IMZTabColumn column, JsonGenerator jg,
            String value) throws IOException {
<span class="fc" id="L687">        writeString(column.getHeader(), jg, value);</span>
<span class="fc" id="L688">    }</span>

    /**
     * &lt;p&gt;
     * writeObject.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param value a {@link java.lang.Object} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeObject(String columnName, JsonGenerator jg,
            SerializerProvider sp,
            Object value) throws IOException {
<span class="fc bfc" id="L705" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L706">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc bfc" id="L708" title="All 2 branches covered.">            if (value instanceof Parameter) {</span>
<span class="fc" id="L709">                jg.writeStringField(columnName, new ParameterConverter().</span>
<span class="fc" id="L710">                        convert((Parameter) value));</span>
<span class="pc bpc" id="L711" title="1 of 2 branches missed.">            } else if (value instanceof String) {</span>
<span class="fc" id="L712">                jg.writeStringField(columnName, (String) value);</span>
            } else {
<span class="nc" id="L714">                throw new IllegalArgumentException(</span>
<span class="nc" id="L715">                        &quot;Serialization of objects of type &quot; + value.getClass()</span>
                        + &quot; currently not supported!&quot;);
            }

        }
<span class="fc" id="L720">    }</span>

    /**
     * &lt;p&gt;
     * writeObject.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp a {@link com.fasterxml.jackson.databind.SerializerProvider}
     * object.
     * @param value a {@link java.lang.Object} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeObject(IMZTabColumn column, JsonGenerator jg,
            SerializerProvider sp, Object value) throws IOException {
<span class="fc" id="L737">        writeObject(column.getHeader(), jg, sp, value);</span>
<span class="fc" id="L738">    }</span>

    /**
     * &lt;p&gt;
     * writeAsNumberArray.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsNumberArray(IMZTabColumn column, JsonGenerator jg,
            List&lt;? extends Number&gt; elements) {
<span class="fc" id="L751">        writeAsNumberArray(column.getHeader(), jg, elements);</span>
<span class="fc" id="L752">    }</span>

    /**
     * &lt;p&gt;
     * writeAsNumberArray.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsNumberArray(String columnName, JsonGenerator jg,
            List&lt;? extends Number&gt; elements) {
        try {
<span class="fc bfc" id="L765" title="All 2 branches covered.">            if (elements == null) {</span>
<span class="fc" id="L766">                jg.writeNullField(columnName);</span>
            } else {
<span class="fc" id="L768">                String arrayElements = elements.stream().</span>
<span class="fc" id="L769">                        map((number)</span>
                                -&gt; {
<span class="fc bfc" id="L771" title="All 2 branches covered.">                            if (number == null) {</span>
<span class="fc" id="L772">                                return MZTabConstants.NULL;</span>
<span class="pc bpc" id="L773" title="1 of 2 branches missed.">                            } else if (number instanceof Short) {</span>
<span class="nc" id="L774">                                return &quot;&quot; + number.shortValue();</span>
<span class="fc bfc" id="L775" title="All 2 branches covered.">                            } else if (number instanceof Integer) {</span>
<span class="fc" id="L776">                                return &quot;&quot; + number.intValue();</span>
<span class="pc bpc" id="L777" title="1 of 2 branches missed.">                            } else if (number instanceof Long) {</span>
<span class="nc" id="L778">                                return &quot;&quot; + number.longValue();</span>
<span class="pc bpc" id="L779" title="1 of 2 branches missed.">                            } else if (number instanceof Float) {</span>
<span class="nc" id="L780">                                return &quot;&quot; + number.floatValue();</span>
                            } else {
<span class="fc" id="L782">                                return &quot;&quot; + number.doubleValue();</span>
                            }
                        }).
<span class="fc" id="L785">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="fc bfc" id="L786" title="All 2 branches covered.">                if (arrayElements.isEmpty()) {</span>
<span class="fc" id="L787">                    jg.writeNullField(columnName);</span>
                } else {
<span class="fc" id="L789">                    jg.writeStringField(columnName, arrayElements);</span>
                }
            }
<span class="nc" id="L792">        } catch (IOException ex) {</span>
<span class="nc" id="L793">            log.error(</span>
                    &quot;Caught IO exception while trying to write as number array: &quot;,
                    ex);
<span class="fc" id="L796">        }</span>
<span class="fc" id="L797">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(IMZTabColumn column, JsonGenerator jg,
            List&lt;String&gt; elements) {
<span class="fc" id="L810">        writeAsStringArray(column.getHeader(), jg, elements);</span>
<span class="fc" id="L811">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(JsonGenerator jg,
            List&lt;String&gt; elements) {
        try {
<span class="nc bnc" id="L823" title="All 2 branches missed.">            if (elements == null) {</span>
<span class="nc" id="L824">                jg.writeNull();</span>
            } else {
<span class="nc" id="L826">                String arrayElements = elements.stream().</span>
<span class="nc" id="L827">                        map((t)</span>
                                -&gt; {
<span class="nc bnc" id="L829" title="All 2 branches missed.">                            if (t == null) {</span>
<span class="nc" id="L830">                                return MZTabConstants.NULL;</span>
                            }
<span class="nc" id="L832">                            return t;</span>
                        }).
<span class="nc" id="L834">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="nc bnc" id="L835" title="All 2 branches missed.">                if (arrayElements.isEmpty()) {</span>
<span class="nc" id="L836">                    jg.writeNull();</span>
                } else {
<span class="nc" id="L838">                    jg.writeString(arrayElements);</span>
                }
            }
<span class="nc" id="L841">        } catch (IOException ex) {</span>
<span class="nc" id="L842">            log.error(&quot;Error while trying to write as string array:&quot;, ex);</span>
<span class="nc" id="L843">        }</span>
<span class="nc" id="L844">    }</span>

    /**
     * &lt;p&gt;
     * writeAsStringArray.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param elements a {@link java.util.List} object.
     */
    public static void writeAsStringArray(String columnName, JsonGenerator jg,
            List&lt;String&gt; elements) {
        try {
<span class="fc bfc" id="L857" title="All 2 branches covered.">            if (elements == null) {</span>
<span class="fc" id="L858">                jg.writeNullField(columnName);</span>
            } else {
<span class="fc" id="L860">                String arrayElements = elements.stream().</span>
<span class="fc" id="L861">                        map((t)</span>
                                -&gt; {
<span class="pc bpc" id="L863" title="1 of 2 branches missed.">                            if (t == null) {</span>
<span class="nc" id="L864">                                return MZTabConstants.NULL;</span>
                            }
<span class="fc" id="L866">                            return t;</span>
                        }).
<span class="fc" id="L868">                        collect(Collectors.joining(&quot;&quot; + MZTabConstants.BAR));</span>
<span class="fc bfc" id="L869" title="All 2 branches covered.">                if (arrayElements.isEmpty()) {</span>
<span class="fc" id="L870">                    jg.writeNullField(columnName);</span>
                } else {
<span class="fc" id="L872">                    jg.writeStringField(columnName, arrayElements);</span>
                }
            }
<span class="nc" id="L875">        } catch (IOException ex) {</span>
<span class="nc" id="L876">            log.error(&quot;Error while trying to write as string array: &quot;, ex);</span>
<span class="fc" id="L877">        }</span>
<span class="fc" id="L878">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(String columnName, JsonGenerator jg,
            Integer value) throws IOException {
<span class="fc bfc" id="L892" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L893">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc" id="L895">            jg.writeNumberField(columnName, value);</span>
        }
<span class="fc" id="L897">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(IMZTabColumn column, JsonGenerator jg,
            Integer value) throws IOException {
<span class="fc" id="L912">        writeNumber(column.getHeader(), jg, value);</span>
<span class="fc" id="L913">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param columnName a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(String columnName, JsonGenerator jg,
            Double value) throws IOException {
<span class="fc bfc" id="L927" title="All 2 branches covered.">        if (value == null) {</span>
<span class="fc" id="L928">            jg.writeNullField(columnName);</span>
        } else {
<span class="fc bfc" id="L930" title="All 2 branches covered.">            if (value.equals(Double.NaN)) {</span>
<span class="fc" id="L931">                jg.writeStringField(columnName, MZTabConstants.CALCULATE_ERROR);</span>
<span class="pc bpc" id="L932" title="1 of 2 branches missed.">            } else if (value.equals(Double.POSITIVE_INFINITY)) {</span>
<span class="nc" id="L933">                jg.writeStringField(columnName, MZTabConstants.INFINITY);</span>
            } else {
<span class="fc" id="L935">                jg.writeNumberField(columnName, value);</span>
            }
        }
<span class="fc" id="L938">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param column a {@link uk.ac.ebi.pride.jmztab2.model.IMZTabColumn}
     * object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(IMZTabColumn column, JsonGenerator jg,
            Double value) throws IOException {
<span class="fc" id="L953">        writeNumber(column.getHeader(), jg, value);</span>
<span class="fc" id="L954">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Integer} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(JsonGenerator jg, Integer value) throws IOException {
<span class="nc bnc" id="L966" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L967">            jg.writeNull();</span>
        } else {
<span class="nc" id="L969">            jg.writeNumber(value);</span>
        }
<span class="nc" id="L971">    }</span>

    /**
     * &lt;p&gt;
     * writeNumber.&lt;/p&gt;
     *
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param value a {@link java.lang.Double} object.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeNumber(JsonGenerator jg, Double value) throws IOException {
<span class="nc bnc" id="L983" title="All 2 branches missed.">        if (value == null) {</span>
<span class="nc" id="L984">            jg.writeNull();</span>
        } else {
<span class="nc" id="L986">            jg.writeNumber(value);</span>
        }
<span class="nc" id="L988">    }</span>

    /**
     * &lt;p&gt;
     * writeOptColumnMappings.&lt;/p&gt;
     *
     * @param optColumnMappings a {@link java.util.List} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param sp the serialization provider.
     * @throws java.io.IOException if an operation on the JsonGenerator object
     * fails.
     */
    public static void writeOptColumnMappings(
            List&lt;OptColumnMapping&gt; optColumnMappings,
            JsonGenerator jg, SerializerProvider sp) throws IOException {
<span class="fc" id="L1003">        for (OptColumnMapping ocm : Optional.ofNullable(</span>
                optColumnMappings).
<span class="fc bfc" id="L1005" title="All 2 branches covered.">                orElse(Collections.emptyList())) {</span>
            // write global or indexed element param objects
<span class="fc bfc" id="L1007" title="All 2 branches covered.">            if (ocm.getParam() != null) {</span>
<span class="fc" id="L1008">                writeObject(Serializers.printOptColumnMapping(ocm), jg, sp, ocm.</span>
<span class="fc bfc" id="L1009" title="All 2 branches covered.">                        getValue() == null</span>
<span class="pc bpc" id="L1010" title="2 of 4 branches missed.">                                ? (ocm.getParam().getValue() == null || ocm.getParam().getValue().isEmpty()</span>
<span class="pc" id="L1011">                                ? NULL : ocm.getParam().getValue()) : ocm.getValue());</span>
            } else { // write global opt column objects with the value
<span class="fc" id="L1013">                writeObject(Serializers.printOptColumnMapping(ocm), jg, sp, ocm.</span>
<span class="fc bfc" id="L1014" title="All 2 branches covered.">                        getValue() == null ? NULL : ocm.getValue());</span>
            }
<span class="fc" id="L1016">        }</span>
<span class="fc" id="L1017">    }</span>

    /**
     * &lt;p&gt;
     * writeIndexedValues.&lt;/p&gt;
     *
     * @param prefix a {@link java.lang.String} object.
     * @param jg a {@link com.fasterxml.jackson.core.JsonGenerator} object.
     * @param values a {@link java.util.List} object.
     */
    public static void writeIndexedDoubles(String prefix,
            JsonGenerator jg, List&lt;Double&gt; values) {
<span class="fc" id="L1029">        IntStream.range(0, values.</span>
<span class="fc" id="L1030">                size()).</span>
<span class="fc" id="L1031">                forEachOrdered(i</span>
                        -&gt; {
                    try {
<span class="fc" id="L1034">                        Serializers.writeNumber(</span>
                                prefix + &quot;[&quot; + (i + 1) + &quot;]&quot;,
                                jg,
                                values.
<span class="fc" id="L1038">                                        get(i));</span>
<span class="nc" id="L1039">                    } catch (IOException ex) {</span>
<span class="nc" id="L1040">                        log.error(</span>
                                &quot;Caught IO exception while trying to write indexed doubles:&quot;,
                                ex);
<span class="fc" id="L1043">                    }</span>
<span class="fc" id="L1044">                });</span>
<span class="fc" id="L1045">    }</span>

    public static void checkIndexedElement(Object element) {
<span class="fc" id="L1048">        Integer id = IndexedElement.of(element).getId();</span>
<span class="pc bpc" id="L1049" title="1 of 2 branches missed.">        if (id == null) {</span>
<span class="nc" id="L1050">            throw new ValidationException(</span>
<span class="nc" id="L1051">                    &quot;'id' field of &quot; + element.toString() + &quot; must not be null!&quot;);</span>
        }
<span class="pc bpc" id="L1053" title="1 of 2 branches missed.">        if (id &lt; 1) {</span>
<span class="nc" id="L1054">            throw new ValidationException(</span>
<span class="nc" id="L1055">                    &quot;'id' field of &quot; + element.toString() + &quot; must have a value greater to equal to 1!&quot;);</span>
        }
<span class="fc" id="L1057">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>